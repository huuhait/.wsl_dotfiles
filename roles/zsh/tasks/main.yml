---
- name: Install zsh
  community.general.pacman:
    name: zsh

- name: Fetch ohmyzsh
  ansible.builtin.uri:
    url: https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh
    return_content: true
  register: ohmyzsh_installer

- name: Run ohmyzsh installer
  ansible.builtin.shell:
    cmd: zsh -s
    stdin: "{{ ohmyzsh_installer.content }}"

- name: Fetch zap-zsh
  ansible.builtin.uri:
    url: https://raw.githubusercontent.com/zap-zsh/zap/master/install.zsh
    return_content: true
  register: zap_installer

- name: Run zap-zsh installer
  ansible.builtin.shell:
    cmd: zsh -s
    stdin: "{{ zap_installer.content }}"

- name: Install dotfiles
  include_tasks: dotfiles.yml
